<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ETS.five.mapper.fiveMapper">
	
	<!-- 공지사항 리스트 -->
	<select id="getNoticeList" resultType="cMap" parameterType="dMap">
		SELECT NOTICE_SEQ
			 , NOTICE_TITLE
			 , NOTICE_CONTENT
			 , IMG_NM
			 , ORG_IMG_NM
			 , DATE_FORMAT(REG_DT, '%Y-%m-%d') as REG_DATE
		  FROM notice
		 WHERE 1=1
		   AND LANG = #{lang}
		 ORDER BY REG_DT DESC
	 	<if test="@org.apache.commons.lang.StringUtils@isNotEmpty(scopeRow)">
	 		LIMIT ${scopeRow}, ${rowCount}
	 	</if>
	</select>
	
	<!-- 공지사항 카운트 -->
	<select id="getNoticeListCount" resultType="int" parameterType="cMap">
		SELECT COUNT(*) AS cnt
		  FROM notice
		 WHERE 1=1
		   AND LANG = #{lang}
		 ORDER BY REG_DT DESC
	</select>
	
	<!-- 공지사항 상세보기 -->
	<select id="getNoticeView" resultType="cMap" parameterType="dMap">
		SELECT NOTICE_SEQ
			 , NOTICE_TITLE
			 , NOTICE_CONTENT
			 , IMG_NM
			 , ORG_IMG_NM
			 , DATE_FORMAT(REG_DT, '%Y-%m-%d') as REG_DATE
		  FROM notice 
		 WHERE NOTICE_SEQ = #{noticeSeq}
	</select>
	
	<!-- 
	
	 
			등록, 수정, 삭제
	
	
	 -->
	
	<!-- 공지사항 삭제 -->
	<delete id="deleteNotice" parameterType="dMap">
		DELETE
		  FROM notice
		 WHERE NOTICE_SEQ IN (${noticeSeq}) 
	</delete>
	
	<!-- 공지사항 등록 -->
	<insert id="insertNotice" parameterType="dMap">
		INSERT INTO notice
		  	 ( LANG, NOTICE_TITLE, NOTICE_CONTENT, IMG_NM, ORG_IMG_NM, REG_DT )
		VALUES
			 ( #{lang}, #{noticeTitle}, #{noticeContent}, #{imgNm}, #{orgImgNm}, now() )
	</insert>
	
	<!-- 공지사항 수정 -->
	<update id="updateNotice" parameterType="dMap">
		 UPDATE notice
		    SET MOD_DT = now()
		      <if test="@org.apache.commons.lang.StringUtils@isNotEmpty(noticeTitle)">
		  	  , NOTICE_TITLE = #{noticeTitle}
			  </if>
		      <if test="@org.apache.commons.lang.StringUtils@isNotEmpty(noticeContent)">
		  	  , NOTICE_CONTENT = #{noticeContent}
			  </if>
			  <if test="@org.apache.commons.lang.StringUtils@isNotEmpty(imgNm)">
		  	  , IMG_NM = #{imgNm}
		  	  </if>
			  <if test="@org.apache.commons.lang.StringUtils@isNotEmpty(orgImgNm)">
		  	  , ORG_IMG_NM = #{orgImgNm}
		  	  </if>
		  WHERE NOTICE_SEQ = ${noticeSeq}
	</update>
	
</mapper>